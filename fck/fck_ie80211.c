#include "../af_common.h"
#include "../af_config.h"
#include "fck_ie80211.h"

uint8_t ie80211_beacon[158] = {
    0x80,                                   /* type/sub type */
    0x00,                                   /* frame control field */
    0x00, 0x00,                             /* duration */
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff,     /* receiver */
    0xd8, 0x5d, 0x4c, 0x25, 0xcb, 0x12,     /* destination(bssid) */
    0xd8, 0x5d, 0x4c, 0x25, 0xcb, 0x12,     /* source */
    0xb0, 0x20, 0x75, 0xb4, 0x93, 0x9a, 0x03, 0x00, 0x00, 0x00,
    0x64, 0x00, 0x31, 0x04, 0x00, 0x07, 0x6c, 0x69, 0x6c, 0x79, 0x7a, 0x61, 0x79, 0x01, 0x08, 0x82,
    0x84, 0x8b, 0x96, 0x0c, 0x18, 0x30, 0x48, 0x03, 0x01, 0x01, 0x05, 0x04, 0x00, 0x01, 0x00, 0x00,
    0x2a, 0x01, 0x00, 0x32, 0x04, 0x12, 0x24, 0x60, 0x6c, 0x30, 0x14, 0x01, 0x00, 0x00, 0x0f, 0xac,
    0x04, 0x01, 0x00, 0x00, 0x0f, 0xac, 0x04, 0x01, 0x00, 0x00, 0x0f, 0xac, 0x02, 0x01, 0x00, 0xdd,
    0x16, 0x00, 0x50, 0xf2, 0x01, 0x01, 0x00, 0x00, 0x50, 0xf2, 0x04, 0x01, 0x00, 0x00, 0x50, 0xf2,
    0x04, 0x01, 0x00, 0x00, 0x50, 0xf2, 0x02, 0xdd, 0x09, 0x00, 0x03, 0x7f, 0x01, 0x01, 0x00, 0x08,
    0xff, 0x7f, 0xdd, 0x1a, 0x00, 0x03, 0x7f, 0x03, 0x01, 0x00, 0x00, 0x00, 0xd8, 0x5d, 0x4c, 0x25,
    0xcb, 0x12, 0xda, 0x5d, 0x4c, 0x25, 0xcb, 0x12, 0x64, 0x00, 0x2c, 0x01, 0x08, 0x08 };

uint8_t ie80211_deauth[] = {};

uint8_t ch_hoop[] = { 1, 6, 11, 3, 8, 13, 5, 10, 2, 7, 12, 4, 9 };

Mac_Addr victim_bss_list[] = VICTIM_LIST;

uint32_t victim_tbl_hash[AF_HASH_TBL_SZ] = { 0 };
uint32_t victim_tbl_len = 0;

int8_t fck_80211_machash()
{
    int8_t ret = FAILURE;
  
    for (victim_tbl_len = 0; victim_tbl_len < sizeof(victim_bss_list)/sizeof(Mac_Addr);
         victim_tbl_len ++)
    {
        //victim_tbl_hash[victim_tbl_len] = (uint32_t)(*(((uint8_t)&victim_bss_list[victim_tbl_len]) + 1));
    }
    
    return ret;
}

void fck_dump_80211_head(ieee80211_header *pkt)
{
    Mac_Addr *addr_rec, *addr_trans, *addr_dst;

    addr_rec    = &pkt->addr_receiver;
    addr_trans  = &pkt->addr_transmitter;
    addr_dst    = &pkt->addr_destination;
    
    af_log("id: %4x, seq: %4x %02x:%02x:%02x:%02x:%02x:%02x -> %02x:%02x:%02x:%02x:%02x:%02x",
            pkt->id_duration, pkt->ctl_seq,
            addr_trans->addr[0], addr_trans->addr[1], addr_trans->addr[2],
            addr_trans->addr[3], addr_trans->addr[4], addr_trans->addr[5],
            addr_rec->addr[0], addr_rec->addr[1], addr_rec->addr[2],
            addr_rec->addr[3], addr_rec->addr[4], addr_rec->addr[5]);
}
